<!DOCTYPE html>

<html lang="en">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-76795314-1', 'auto');
  ga('send', 'pageview');

</script>
  <head>
    <title>  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html"> Docs</a> (100% documented)</p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html"> Reference</a>
        <img id="carat" src="img/carat.png" />
          Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/CaffeineHTTPProxy.html">CaffeineHTTPProxy</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enums</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/HTTPMethod.html">HTTPMethod</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/URLSessionConfiguration.html">URLSessionConfiguration</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <a href='#contact-our-engineers-at-a-href-mailto-help-caffei-net-help-caffei-net-a-for-a-trial' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='contact-our-engineers-at-a-href-mailto-help-caffei-net-help-caffei-net-a-for-a-trial'>Contact our engineers at <a href="mailto:help@caffei.net">help@caffei.net</a> for a trial.</h3>
            <h3>Want to A/B Test Caffeine? <a href="./ABTesting.html">Click here</a></h3>
<a href='#integration-getting-started' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='integration-getting-started'>Integration/Getting Started</h1>

<p>No backend changes. Takes about 15 minutes inside Xcode. You work with three APIs inside the <a href="./Classes/CaffeineHTTPProxy.html">CaffeineHTTPProxy</a> class. The steps are described below. </p>
<a href='#steps-to-integrate' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='steps-to-integrate'>Steps to Integrate</h2>

<p>You should have received a Caffeine bundle containing six items: four frameworks and two files (picture below) which you will copy into your application bundle. If you have not, please contact us at <a href="mailto:help@caffei.net">help@caffei.net</a>. </p>

<p><img src="./CaffeineBundleSS.png" alt="CaffeineBundle"></p>

<ul>
<li>The caffeine.license file is required to use Caffeine. It contains information that uniquely identifies your organization.</li>
<li>CocoaAsyncSocket.framework is an <a href="https://github.com/robbiehanson/CocoaAsyncSocket">open source library</a> that Caffeine uses for fast-UDP diagnostic logging.</li>
<li>NaOH.framework (pronounced <q>sodium hydroxide</q>) is an <a href="https://code.sealedabstract.com/drewcrawford/NaOH">open source library</a> built and maintained by us - forked from <a href="https://github.com/jedisct1/libsodium">libsodium</a>, implementing Caffeine’s security.</li>
<li>Nitrogen.framework contains our proprietary protocol.</li>
<li>Proxeine.framework is the interpreter (proxy) that converts whatever
networking library is used on the client into Caffeine.</li>
<li>Proxy.key contains the public key the client will use to authenticate with
our proxy server.</li>
</ul>
<a href='#1-drag-and-drop-the-four-frameworks-into-the-embedded-binaries-section-in-xcode-found-on-the-project-s-general-tab-in-the-subsequent-prompt-make-sure-to-check-copy-items-if-needed-before-pressing-finish' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='1-drag-and-drop-the-four-frameworks-into-the-embedded-binaries-section-in-xcode-found-on-the-project-s-general-tab-in-the-subsequent-prompt-make-sure-to-check-copy-items-if-needed-before-pressing-finish'>1. Drag and drop the four frameworks into the Embedded Binaries section in Xcode (found on the project’s general tab). In the subsequent prompt, make sure to check “Copy items if needed” before pressing “Finish”.</h3>

<p><img src="./DragAndDropSS.png" alt="DragAndDropSS"></p>

<p><img src="./FrameworksFinalCopySS.png" alt="FrameworksFinalCopySS"></p>
<a href='#you-should-now-see-all-four-frameworks-present-within' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='you-should-now-see-all-four-frameworks-present-within'>You should now see all four frameworks present within</h3>

<p>a)  Xcode’s Project Navigator</p>

<p>b)  The Embedded Binaries section</p>

<p>c)  The Linked Frameworks and Libraries section</p>

<p>(pictured below)</p>

<p><img src="./FrameworksPresentWithinSS.png" alt="FrameworksPresentWithinSS"></p>
<a href='#2-drag-and-drop-the-code-proxy-key-code-and-code-caffeine-license-code-into-the-xcode-project-and-add-and-copy-to-the-main-application-target-again-ensure-that-copy-items-if-needed-is-checked-in-the-subsequent-prompt' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='2-drag-and-drop-the-code-proxy-key-code-and-code-caffeine-license-code-into-the-xcode-project-and-add-and-copy-to-the-main-application-target-again-ensure-that-copy-items-if-needed-is-checked-in-the-subsequent-prompt'>2. Drag and drop the <code>proxy.key</code> and <code>caffeine.license</code> into the Xcode project and add (and copy) to the main application target. Again, ensure that “Copy items if needed” is checked in the subsequent prompt.</h3>

<p><img src="./DragAndDropFilesSS.png" alt="DragAndDropFilesSS"></p>

<p><img src="./AddingToMainTargetSS.png" alt="AddingToMainTargetSS"></p>
<a href='#you-should-now-see-the-two-files-caffeine-license-and-proxy-key-within-xcode-s-project-navigator-pictured-below' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='you-should-now-see-the-two-files-caffeine-license-and-proxy-key-within-xcode-s-project-navigator-pictured-below'>You should now see the two files “caffeine.license” and “proxy.key” within Xcode’s Project Navigator (pictured below)</h3>

<p><img src="./FilesPresentInNavigatorSS.png" alt="FilesPresentInNavigatorSS"></p>
<a href='#3-in-the-main-target-s-build-settings-set-embedded-content-contains-swift-code-to-yes' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='3-in-the-main-target-s-build-settings-set-embedded-content-contains-swift-code-to-yes'>3. In the main target’s build settings, set “Embedded Content Contains Swift Code” to Yes</h3>

<p><img src="./EmbeededContainsSwiftSS.png" alt="EmbeededContainsSwiftSS"></p>
<a href='#4-in-your-app-delegate-import-the-proxeine-framework' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='4-in-your-app-delegate-import-the-proxeine-framework'>4. In your App Delegate, import the Proxeine framework.</h3>

<p>Swift:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">Proxeine</span>
</code></pre>

<p>Objective-C:</p>
<pre class="highlight objective_c"><code><span class="cp">#import &lt;Proxeine/Proxeine-Swift.h&gt;
</span></code></pre>
<a href='#5-locate-the-code-application-didfinishlaunchingwithoptions-code-function-and-call-the-code-start-code-function' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='5-locate-the-code-application-didfinishlaunchingwithoptions-code-function-and-call-the-code-start-code-function'>5. Locate the <code>application:didFinishLaunchingWithOptions:</code> function and call the <code>start()</code> function:</h3>

<p>Swift:</p>
<pre class="highlight swift"><code><span class="kt">CaffeineHTTPProxy</span><span class="o">.</span><span class="nf">start</span><span class="p">()</span>
</code></pre>

<p>Objective-C: </p>
<pre class="highlight objective_c"><code><span class="p">[</span><span class="n">CaffeineHTTPProxy</span> <span class="nf">start</span><span class="p">];</span>
</code></pre>
<a href='#6-caffeine-defaults-to-off-so-no-traffic-will-be-accelerated-until-specific-urls-or-sets-of-urls-are-specified-this-is-done-through-caffeinehttpproxy-s-allow-and-deny-functions' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='6-caffeine-defaults-to-off-so-no-traffic-will-be-accelerated-until-specific-urls-or-sets-of-urls-are-specified-this-is-done-through-caffeinehttpproxy-s-allow-and-deny-functions'>6. Caffeine defaults to off, so no traffic will be accelerated until specific URLs or sets of URLs are specified. This is done through CaffeineHTTPProxy’s allow and deny functions.</h3>

<p>Swift: </p>
<pre class="highlight swift"><code><span class="kt">CaffeineHTTPProxy</span><span class="o">.</span><span class="nf">allow</span><span class="p">(</span><span class="err">“</span><span class="nv">http</span><span class="p">:</span><span class="c1">//google.com”)</span>
</code></pre>

<p>Objective-C:</p>
<pre class="highlight objective_c"><code><span class="p">[</span><span class="n">CaffeineHTTPProxy</span> <span class="nf">allow</span><span class="p">:</span><span class="err">@”</span><span class="nf">http</span><span class="p">:</span><span class="c1">//google.com”];
</span></code></pre>

<p>To accelerate sets of URLs use the asterisk <q>*</q> to denote prefixes or suffixes.</p>

<p>Swift: </p>
<pre class="highlight swift"><code><span class="kt">CaffeineHTTPProxy</span><span class="o">.</span><span class="nf">allow</span><span class="p">(</span><span class="s">"http://google.com/*"") //everything starting with http://google.com/
CaffeineHTTPProxy.allow("</span><span class="o">*.</span><span class="n">jpg</span><span class="s">") //all urls ENDING in .jpg
CaffeineHTTPProxy.deny("</span><span class="nv">https</span><span class="p">:</span><span class="c1">//google.com/") // prevents HTTPS acceleration to the single URL, `https://google.com/`</span>
</code></pre>

<p>Objective-C:</p>
<pre class="highlight objective_c"><code><span class="p">[</span><span class="n">CaffeineHTTPProxy</span> <span class="nf">allow</span><span class="p">:</span><span class="err">@”</span><span class="nf">http</span><span class="p">:</span><span class="c1">//google.com/*"];
</span></code></pre>

<p>See CaffeineHTTPProxy&rsquo;s <a href="./Classes/CaffeineHTTPProxy.html#/s:ZFC8Proxeine17CaffeineHTTPProxy5allowFSST_">allow:</a> and <a href="./Classes/CaffeineHTTPProxy.html#/s:ZFC8Proxeine17CaffeineHTTPProxy4denyFSST_">deny:</a> for more examples of usage. </p>

<a href='#steps-to-submit' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='steps-to-submit'>Steps to Submit to app store</h2>

<p>Caffeine frameworks are compiled both for simulator and device (pretty convenient for development), but iTunesConnect doesn't accept simulator slices. So, a Run Script must be added to remove the simulator slices. <br /> The following 3 steps describe a solution.</p>

<a href='#steps_to_integrate' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='steps_to_integrate'>Step #1</h2>

<p>Install <a href="https://github.com/Carthage/Carthage">Carthage</a>. In terminal,

  <pre class="highlight swift"><code><span class="kt">brew install Carthage</span>
</code></pre> </p>

<a href='#steps_to_integrate' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='steps_to_integrate'>Step #2</h2>
 <p>Under your application's target settings in the "Build Phases" tab, create a new "Run Script Phase"</p>
 <p><img src="./img/Submission_BuildPhaseTab.png" alt="Submission_BuildPhaseTab"></p>

 <a href='#steps_to_integrate' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='steps_to_integrate'>Step #3</h2>

 <p>In your newly created Run Script, enter the following: </p>
 <pre class="highlight swift"><code><span class="kt">/usr/local/bin/carthage copy-frameworks</span>
</code></pre>

<p>And for input files: </p>
 <pre class="highlight swift"><code><span class="kt">$(SRCROOT)/NaOH.framework<br />$(SRCROOT)/Nitrogen.framework<br />$(SRCROOT)/Proxeine.framework<br />$(SRCROOT)/CocoaAsyncSocket.framework</span>
</code></pre>

<img src="./img/Submission_RunScript_InputFiles.png" alt="RunScriptInputFiles">

<p>That will cause the simulator parts to be stripped during an archive. <p>If at any time you require help, please contact our engineers at <a href="mailto:help@caffei.net">help@caffei.net</a></p></p>


<p><img src="./AppDelegateSS.png" alt="AppDelegateSS"></p>
<a href='#about-caffeine' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='about-caffeine'>About Caffeine</h2>

<p>Caffeine is the result of many frustrated years spent developing native applications for our clients on a contracting and consulting basis.
Application speed has many components, but in our experience one of the most frustrating is network latency–the performance tax you pay simply for talking on the network.
Mobile engineers have control over the other factors, like client-side and server-side performance. But the network performance has remained relatively constant and elusively outside of engineering’s reach until now. Caffeine challenges the commonly held assumptions of performance in a purely software solution.</p>
<a href='#the-two-fundamental-speed-limitations-in-networking' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='the-two-fundamental-speed-limitations-in-networking'>The Two Fundamental Speed Limitations in networking</h3>

<ul>
<li>Bandwidth: bits per second of data</li>
<li>Latency: time between a request and a response</li>
</ul>

<p>Bandwidth is ultimately limited by the carrier’s networking hardware. Latency is primarily limited by two features: the speed of electricity through electrical wire—very roughly &frac12; the speed of light in a vacuum (1/2c), and the geographic efficiency of the network path (straightness of line). Because carriers define speed limits, people commonly assume that performance can’t improve. But more efficient protocols require less bandwidth and less latency, even if the speed limits are the same.
Caffeine, a “pure software” solution, aggressively targets <strong>both</strong> fundamental limits –the bandwidth
<strong>and</strong> latency efficiency of the request. We send less data and incur fewer round-trips than the equivalent HTTPS implementation. The exact techniques we use to do this are proprietary, but the underlying math is simple.</p>
<a href='#an-example' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='an-example'>An Example</h3>

<p>If we allow that there are 6000km from Boston to Switzerland (where the server is in <a href="https://vimeo.com/156772511">our search demo</a>), and that the speed of electricity is 1/2c, then a round-trip request/response there and back again is about 20ms. If we further allow a 2x inefficiency because the networking cable is not in a straight line and that each of the 20 hops on the path add about 2ms of queuing latency then we are up to 80ms. This estimate is roughly consistent with empirical results from ping (using the ICMP).
There is no reason why we could not theoretically make a request in 80ms. Quite simply, if you aren’t seeing 80ms request/response times right now, your application is traveling slower than the network speed limit allows.
Caffeine technology is engineered tightly to this network speed limit. The result is a network technology that is much more efficient than traditional technology, often by a factor of 2X or more.</p>
<a href='#datacenter-grade-communications' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='datacenter-grade-communications'>Datacenter-grade Communications</h3>

<p>We are not the first people to realize this; in fact our research suggests that both Facebook and Amazon (and probably all the others) are doing things like this inside their data-centers. But their technology is kept hidden behind the firewall. Caffeine is <q>datacenter-grade</q> networking that we want to make available to everyone.</p>
<a href='#an-important-detail' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='an-important-detail'>An Important Detail</h2>

<p>Caffeine runs in a very important part of your application. </p>

<p>If anything unexpected occurs, Caffeine will fallback to using HTTP/S where it is appropriate to do so. </p>

<p>The below table describes this behavior:</p>

<p><img src="./HTTPRetryTable.png" alt="HTTP Retry by error table"></p>
<a href='#more-technical-information' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='more-technical-information'>More technical information</h2>

<p>A report of Caffeine&rsquo;s effect on image downloading may be found <a href="./MIDWriteup.pdf">here</a></p>
<a href='#closing-remarks' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='closing-remarks'>Closing Remarks</h2>

<p>It is after more than a year of meticulous engineering and testing that we feel comfortable inviting organizations to work with us. We take great pride in our technology, and it&rsquo;s essential to us that it pushes your applications forward. </p>

<p>Caffeine is our craft, our art, our lives. We&rsquo;re not web developers, graphic designers, or wordsmiths; we&rsquo;re iOS developers, and that&rsquo;s pretty much it. We do one thing, and we do it well: we build tools that allow you to create experiences on the iPhone that others write off as impossible. </p>

<p>As far as we know (and we don&rsquo;t know everything, but we know enough), our technology is the fastest secure networking software for iOS applications in the world. We believe that we can at least double your iOS application&rsquo;s network performance.   </p>

<p>It&rsquo;s an exciting time for us, and we are very fortunate to be able to collaborate with great customers to make their exceptional apps even better.  We jump at the opportunity to work with organizations that share our values of both end user experience and quality software development. </p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2017 <a class="link" href="" target="_blank" rel="external"></a>. All rights reserved. (Last updated: 2017-01-18)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.7.3</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
